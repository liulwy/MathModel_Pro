# 烟幕干扰弹投放策略模型（问题三）

## 1. 问题描述与建模思路

问题三要求设计无人机FY1投放3枚烟幕干扰弹的策略，以最大化对导弹M1的干扰效果。需要确定无人机的飞行方向、飞行速度以及3枚干扰弹的投放时间与起爆时间，满足干扰弹投放至少间隔1秒的约束。

### 1.1 模型建立思路

在问题一、二的基础上，我们将模型扩展为"一机三弹"的联合优化：
- 继续使用问题二的"圆柱体表面采样+全视线覆盖判据"
- 增加决策变量，处理多弹投放的时序约束
- 采用"或"逻辑联合判断遮蔽：任一时刻，只要3枚云团中有任意一枚能完全覆盖目标视线，即视为遮蔽成功
- 采用改进的PSO算法求解高维优化问题

## 2. 数学模型

### 2.1 决策变量
优化参数增加至8个：
$\mathbf{x} = [\theta, v_F, t_1, d_1, \text{gap}_2, d_2, \text{gap}_3, d_3]$

其中：
- $\theta \in [-\pi, \pi]$：无人机航向角
- $v_F \in [70, 140]$ m/s：无人机飞行速度
- $t_1 \in [0, 10]$ s：第一枚干扰弹投放时间
- $d_1 \in [0, 6]$ s：第一枚干扰弹起爆延迟
- $\text{gap}_2 \in [0, 6]$ s：第二枚相对第一枚的额外间隔时间
- $d_2 \in [0, 6]$ s：第二枚干扰弹起爆延迟
- $\text{gap}_3 \in [0, 6]$ s：第三枚相对第二枚的额外间隔时间
- $d_3 \in [0, 6]$ s：第三枚干扰弹起爆延迟

### 2.2 约束条件

1. 投放间隔至少1秒（通过参数映射实现）：
   $$t_2 = t_1 + 1 + \text{gap}_2$$
   $$t_3 = t_2 + 1 + \text{gap}_3$$

2. 变量边界约束：
   $$\theta \in [-\pi, \pi]$$
   $$v_F \in [70, 140]$$
   $$t_1 \in [0, 10],\ d_1, d_2, d_3, \text{gap}_2, \text{gap}_3 \in [0, 6]$$

### 2.3 运动学模型

1. 无人机FY1轨迹：
   $$\mathbf{F}(t) = \mathbf{F}_0 + v_F t \cdot [\cos\theta, \sin\theta, 0]^T$$

2. 导弹M1轨迹：
   $$\mathbf{M}(t) = \mathbf{M}_0 + v_M t \cdot \mathbf{u}_M$$

3. 第$k$枚干扰弹轨迹（$k=1,2,3$）：
   $$\mathbf{B}_k(t) = 
   \begin{cases}
   \mathbf{F}(t), & \text{if } t < t_k \\
   \mathbf{F}(t_k) + v_F(t-t_k)[\cos\theta, \sin\theta, 0]^T + [0,0,-\frac{1}{2}g(t-t_k)^2]^T, & \text{if } t \geq t_k
   \end{cases}
   $$

4. 第$k$枚云团中心轨迹：
   $$\mathbf{C}_k(t) = 
   \begin{cases}
   \text{云团尚未形成}, & \text{if } t < t_k + d_k \\
   \mathbf{B}_k(t_k + d_k) + [0,0,-v_{\text{sink}}(t-(t_k+d_k))]^T, & \text{if } t \geq t_k + d_k
   \end{cases}
   $$

### 2.4 遮蔽判据

沿用问题二的圆柱体表面采样与全视线判据，从圆柱体表面（侧面+顶面，不含底面）取N个采样点$\mathbf{T}_j$。

1. 单个云团$k$对时刻$t$的视线覆盖判定：
   $$I_k(t) = 
   \begin{cases}
   1, & \text{if } \max_j d_j^2(k,t) \leq r_{\text{cloud}}^2 \\
   0, & \text{otherwise}
   \end{cases}
   $$

   其中$d_j^2(k,t)$为导弹位置$\mathbf{M}(t)$到目标点$\mathbf{T}_j$的视线与云团中心$\mathbf{C}_k(t)$的最小距离平方。

2. 联合遮蔽判据（多弹"或"逻辑）：
   $$I_{\text{joint}}(t) = 
   \begin{cases}
   1, & \text{if } \max_k I_k(t) = 1 \\
   0, & \text{otherwise}
   \end{cases}
   $$

   即任一云团能完全覆盖所有视线，则该时刻成功遮蔽。

### 2.5 目标函数

最大化联合遮蔽时长：
$$\max_{\mathbf{x}} J(\mathbf{x}) = \int_{t_{\min}}^{t_{\max}} I_{\text{joint}}(t) dt$$

其中$t_{\min} = \min_k (t_k + d_k)$，$t_{\max} = \max_k (t_k + d_k + t_{\text{window}})$。

## 3. 求解算法

### 3.1 改进PSO算法设计

采用改进的粒子群优化算法（AcceleratedPSO）解决高维优化问题，主要特点：

1. **启发式初始化**：
   - 20%粒子均匀随机初始化
   - 20%粒子围绕问题二最优解附近扰动
   - 30%粒子采用均匀分布的时序策略
   - 30%粒子随机初始化

2. **动态参数调整**：
   - 惯性权重$w$从0.9线性降至0.4
   - 认知/社会因子$c_1=1.8$, $c_2=1.8$保持固定

3. **局部搜索增强**：
   - 周期性局部搜索：每隔10次迭代进行局部精细搜索
   - 搜索半径随迭代逐步缩小
   - 优化结束前进行一次精细局部搜索
   - 超时保护机制：局部搜索限时60秒，避免卡死

4. **并行计算加速**：
   - 利用多进程并行评估粒子适应度
   - 自动使用所有可用CPU核心

### 3.2 目标函数计算优化

针对计算密集型的遮蔽时长评估，采用以下优化策略：

1. **自适应时间采样**：
   - 粗采样（步长0.1s）快速定位遮蔽区间
   - 细采样（步长0.02s）精确计算区间遮蔽时长

2. **早期终止策略**：
   - 一旦找到任一云团可以覆盖所有视线，立即判定为遮蔽成功
   - 跳过未起爆或已失效的云团

3. **向量化距离计算**：
   - 使用numpy高效计算点到线段的最短距离
   - 避免使用循环，提高计算效率

4. **区间边界精确计算**：
   - 对遮蔽区间的边界点进行精细计算
   - 提高总遮蔽时长计算的准确性

## 4. 数值实验与结果分析

### 4.1 实现细节

- 圆柱体表面采样点数：150
- PSO参数：粒子数60，迭代次数250
- 局部搜索：每10次迭代进行，搜索半径随迭代缩小
- 时间步长：粗采样0.1s，细采样0.02s
- 超时保护：局部搜索60秒限时，防止计算卡死

### 4.2 收敛性分析

PSO算法的收敛性通过迭代历史曲线来展示，从曲线可以观察到：
- 早期阶段（前50次迭代）快速收敛
- 中期阶段（50-150次迭代）收敛速度放缓
- 后期阶段（150-250次迭代）微调优化
- 最终局部搜索对结果进行精细调整

收敛曲线保存为高分辨率图像（300dpi），便于分析优化过程。

### 4.3 最优解分析

优化得到的最优策略包含以下关键参数：
- 无人机航向角θ（度）：约7.24°
- 无人机飞行速度vF（m/s）：约118.91 m/s
- 三枚干扰弹的投放时间序列：通过合理的间隔确保持续干扰效果
- 每枚干扰弹的有效遮蔽时长及其联合遮蔽时长

通过单独计算每枚烟幕弹的遮蔽贡献，我们发现：
- 三枚烟幕弹各自能提供不同的遮蔽时段
- 通过合理的时序安排，最大化了总遮蔽时长
- 联合遮蔽时长显著优于单枚烟幕弹的最大遮蔽时长

结果已保存到"../src/result1.xlsx"文件中，按照要求的格式展示了所有关键参数。

### 4.4 遮蔽效果可视化

通过时间轴可视化展示了三枚烟幕弹的遮蔽状态：
- 联合遮蔽状态随时间的变化曲线
- 每枚烟幕弹的投放时刻、起爆时刻和有效期
- 各烟幕弹的有效遮蔽区间和遮蔽时长
- 整体遮蔽效果的时空分布

可视化结果显示，通过三枚烟幕弹的协同作用，有效扩展了总体遮蔽时长，实现了持续干扰效果。

## 5. 模型创新点与局限性

### 5.1 创新点

1. **时空协同优化**：
   - 通过优化投放时序实现空间分布的协同效应
   - 利用多弹联合作用最大化遮蔽时长

2. **改进的PSO算法**：
   - 混合初始化策略提高搜索效率
   - 周期性局部搜索避免陷入局部最优
   - 超时保护机制防止局部搜索卡死
   - 并行计算加速目标函数评估

3. **自适应采样技术**：
   - 两阶段采样策略平衡计算效率与精度
   - 避免在全时间窗上使用统一的精细采样

4. **单弹贡献分析**：
   - 计算每枚烟幕弹的独立遮蔽贡献
   - 评估多弹协同效应的增益

### 5.2 局限性

1. **算法局限**：
   - PSO为随机搜索算法，无法保证找到全局最优解
   - 高维搜索空间增加了求解难度

2. **模型简化**：
   - 采用恒定烟雾云团半径，未考虑云团扩散和衰减
   - 未考虑风场对云团运动的影响
   - 忽略了导弹可能的规避机动

3. **计算效率**：
   - 即使采用并行计算和优化策略，高精度计算仍然耗时
   - 局部搜索可能受困于复杂地形

## 6. 结论

本模型成功扩展了问题一、二的建模思路，通过改进的PSO算法和自适应计算技术，解决了"一机三弹"投放策略的高维优化问题。通过时空协同优化，实现了烟雾干扰弹的最佳投放策略，最大化对来袭导弹的干扰效果。

具体成果包括：
1. 确定了无人机最优航向角（约7.24°）和速度（约118.91 m/s）
2. 设计了三枚烟幕弹的最优投放时序和起爆延迟
3. 通过可视化展示了三枚烟幕弹的协同遮蔽效果
4. 量化了单枚烟幕弹的贡献和整体遮蔽时长

联合遮蔽时长比单弹方案明显提高，证明了多弹协同投放的优势。最终优化结果已保存至"../src/result1.xlsx"文件，符合问题要求。